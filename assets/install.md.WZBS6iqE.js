import{_ as a,D as i,c as n,l as e,a as s,I as o,a4 as l,o as r}from"./chunks/framework.DZXLJAMc.js";const p="/kasten-ocpv-lab/assets/00.C7Msu1ia.png",h="/kasten-ocpv-lab/assets/01.DkQxWqE7.png",c="/kasten-ocpv-lab/assets/02.Bb2Fy-ZV.png",d="/kasten-ocpv-lab/assets/03.saAYNyZP.png",g="/kasten-ocpv-lab/assets/04.Dgz-r7r0.png",k="/kasten-ocpv-lab/assets/05.DsVRcOmu.png",m="/kasten-ocpv-lab/assets/06.CfRTdZIk.png",u="/kasten-ocpv-lab/assets/07.ivoAYWeR.png",b="/kasten-ocpv-lab/assets/08.BAVHy5p3.png",F="/kasten-ocpv-lab/assets/09.upTS8_GO.png",v="/kasten-ocpv-lab/assets/10.NWjqRQh7.png",V=JSON.parse('{"title":"Installing Veeam Kasten","description":"","frontmatter":{},"headers":[],"relativePath":"install.md","filePath":"install.md"}'),C={name:"install.md"},f={id:"installing-veeam-kasten",tabindex:"-1"},y=e("a",{class:"header-anchor",href:"#installing-veeam-kasten","aria-label":'Permalink to "Installing Veeam Kasten <Badge type="tip" text="v6.5.13" />"'},"​",-1),_=l('<h2 id="_1-introduction" tabindex="-1">1. Introduction <a class="header-anchor" href="#_1-introduction" aria-label="Permalink to &quot;1. Introduction&quot;">​</a></h2><p>This add-on lab guide is intended to familiarize practitioners with the protection of OpenShift Virtualization workloads using <em><strong>Veeam Kasten for Kubernetes</strong></em>. It assumes the learner has completed other <em><strong>OpenShift Virtualization Roadshow</strong></em> lab exercises and are familiar with virtual machine provisioning and management in OpenShift.</p><h3 id="what-is-veeam-kasten" tabindex="-1">What is Veeam Kasten? <a class="header-anchor" href="#what-is-veeam-kasten" aria-label="Permalink to &quot;What is Veeam Kasten?&quot;">​</a></h3><p><em><strong>Veeam Kasten for Kubernetes</strong></em> is a purpose-built data protection solution for Kubernetes that enables organizations to perform backup &amp; restore, disaster recovery, and cross-cluster mobility of their applications.</p><h3 id="how-does-kasten-work" tabindex="-1">How does Kasten work? <a class="header-anchor" href="#how-does-kasten-work" aria-label="Permalink to &quot;How does Kasten work?&quot;">​</a></h3><p><img src="'+p+'" alt=""></p><ol><li>Kasten is deployed to the cluster that it protects. Within the cluster, Kasten communicates with the Kubernetes API server to discover applications and their resources.</li><li>Kasten orchestrates point-in-time snapshots of complete applications, including both application manifest data and storage volume data.</li><li>Kasten exports portable copies of the point-in-time snapshot to an external object, NFS, or Veeam repository.</li></ol><hr><p><em>In the first exercise you will install Veeam Kasten through the OpenShift OperatorHub and access the dashboard user interface via an OpenShift Route.</em></p><h2 id="_2-running-primer-script" tabindex="-1">2. Running Primer Script <a class="header-anchor" href="#_2-running-primer-script" aria-label="Permalink to &quot;2. Running Primer Script&quot;">​</a></h2><ol><li><p>In the <em><strong>OpenShift Console</strong></em>, open the <em><strong>Web Terminal</strong></em> and click <em><strong>Start</strong></em> to initialize the terminal (if prompted).</p><p><img src="'+h+`" alt=""></p></li><li><p>In the <em><strong>Web Terminal</strong></em>, run the following to run the Kasten &quot;primer&quot; script to evaluate your target cluster configuration prior to Kasten installation:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> repo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kasten</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://charts.kasten.io/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> repo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://docs.kasten.io/tools/k10_primer.sh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> bash</span></span></code></pre></div><p>You should expect to see one or more occurrences of the error below:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark has-highlighted vp-code"><code><span class="line"><span>...</span></span>
<span class="line highlighted error"><span>At least 1 VolumeSnapshotClass needs the k10.kasten.io/is-snapshot-class annotation set to true. - Error</span></span>
<span class="line"><span>...</span></span></code></pre></div><p>The <code>k10.kasten.io/is-snapshot-class</code> annotation is used by Kasten to determine which VolumeSnapshotClass should be used by Kasten to request CSI snapshots for PersistentVolumes provisioned by a given CSI provider.</p></li><li><p>Run the following to annotate the available VolumeSnapshotClasses and re-run the primer script:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">oc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> annotate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> volumesnapshotclass</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  ocs-storagecluster-rbdplugin-snapclass</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  k10.kasten.io/is-snapshot-class=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">oc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> annotate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> volumesnapshotclass</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  ocs-storagecluster-cephfsplugin-snapclass</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  k10.kasten.io/is-snapshot-class=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://docs.kasten.io/tools/k10_primer.sh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> bash</span></span></code></pre></div><p>The primer should now complete without errors, indicating any common configuration issues have been addressed.</p><div class="note custom-block github-alert"><p class="custom-block-title">NOTE</p><p></p><p>Running the primer script is not required to install Kasten, but is highly recommended.</p><p>The script can also be used to validate CSI VolumeSnapshot creation and restore capabilities. See <a href="https://docs.kasten.io/latest/install/storage.html#csi-preflight" target="_blank" rel="noreferrer">docs.kasten.io</a>.</p></div></li><li><p>Close the <em><strong>Web Terminal</strong></em>.</p></li></ol><h2 id="_3-installing-kasten" tabindex="-1">3. Installing Kasten <a class="header-anchor" href="#_3-installing-kasten" aria-label="Permalink to &quot;3. Installing Kasten&quot;">​</a></h2><ol><li><p>In the <em><strong>OpenShift Console</strong></em>, search for <code>Kasten</code> in the <em><strong>OperatorHub</strong></em> and select <em><strong>Kasten K10 (Free)</strong></em>:</p><p><img src="`+c+'" alt=""></p><div class="note custom-block github-alert"><p class="custom-block-title">NOTE</p><p></p><p>Alternate versions of the Kasten operator are available for use if transacting Kasten licensing through the Red Hat Marketplace.</p><p>If desired, Kasten may also be <a href="https://docs.kasten.io/latest/install/openshift/helm.html#helm-based-installation" target="_blank" rel="noreferrer">installed on OpenShift via Helm chart</a>.</p></div></li><li><p>Click <em><strong>Install</strong></em>.</p></li><li><p>Click <em><strong>Install</strong></em> to initiate operator installation using the default settings.</p><p><img src="'+d+'" alt=""></p></li><li><p>After operator installation completes, click <em><strong>View Operator</strong></em> (or select <em><strong>Operators → Installed Operators → Kasten K10 (Free)</strong></em> from the sidebar).</p></li><li><p>Under <em><strong>Provided APIs &gt; K10</strong></em>, click <em><strong>+ Create instance</strong></em>.</p><p><img src="'+g+'" alt=""></p></li><li><p>Under <em><strong>Form view</strong></em>, toggle the following options to <em><strong>True</strong></em>:</p><ul><li><em><strong>Enable Token Based Authentication</strong></em></li><li><em><strong>Enable K10 dashboard to be exposed via route</strong></em></li><li><em><strong>Create secured edge route for exposing K10</strong></em></li></ul><p><img src="'+k+'" alt=""></p><div class="note custom-block github-alert"><p class="custom-block-title">NOTE</p><p></p><p>The Kasten installation can be further customized using the YAML view. A complete list of configuration parameters is <a href="https://docs.kasten.io/latest/install/advanced.html#complete-list-of-k10-helm-options" target="_blank" rel="noreferrer">available on docs.kasten.io</a>.</p></div></li><li><p>Click <em><strong>Create</strong></em>.</p></li><li><p>From the <em><strong>Web Terminal</strong></em>, run the following to monitor the installation:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">watch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pods</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kasten-io</span></span></code></pre></div></li><li><p>Once all Deployments are <em><strong>READY</strong></em>, press <code>CTRL+C</code> to end the <code>watch</code>.</p><p><img src="'+m+'" alt=""></p></li><li><p>Run the following to obtain the token for the <code>admin</code> user currently logged into the OpenShift console and copy the output to the clipboard:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">oc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> whoami</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span></span></code></pre></div><div class="note custom-block github-alert"><p class="custom-block-title">NOTE</p><p></p><p>This token will be used to authenticate to Kasten as your current OpenShift user. In addition to Kubernetes bearer tokens, Kasten also supports authentication using OpenID Connect (OIDC), Active Directory (LDAP), and OpenShift&#39;s built-in OAuth server.</p></div></li><li><p>Close the <em><strong>Web Terminal</strong></em>.</p></li></ol><h2 id="_4-accessing-the-kasten-dashboard" tabindex="-1">4. Accessing the Kasten Dashboard <a class="header-anchor" href="#_4-accessing-the-kasten-dashboard" aria-label="Permalink to &quot;4. Accessing the Kasten Dashboard&quot;">​</a></h2><ol><li><p>In the <em><strong>OpenShift Console</strong></em>, select <em><strong>Networking → Routes</strong></em> from the sidebar and open the <code>k10-route</code> Route URL.</p><p><img src="'+u+'" alt=""></p></li><li><p>Paste the <code>admin</code> token value from the previous exercise and click <em><strong>Sign-in</strong></em>.</p><p><img src="'+b+'" alt=""></p></li><li><p>Specify <em><strong>Email</strong></em> and <em><strong>Company name</strong></em> values and click <em><strong>Accept Terms</strong></em>.</p><p><img src="'+F+'" alt=""></p><p>You should observe that the <em><strong>Kasten Dashboard</strong></em> is being accessed as your cluster&#39;s <code>admin</code> user.</p><p><img src="'+v+'" alt=""></p><div class="note custom-block github-alert"><p class="custom-block-title">NOTE</p><p></p><p>Kasten ships with multiple built-in user roles, including <code>k10-admin</code> and <code>k10-basic</code>. As Kasten is built on Kubernetes-native resources, custom roles can be built and bound to users/groups to define fine-grained access on a per namespace level. This helps to allow secure self-service for end users who may need to manage their own policies or restores without dependence on a data protection administrator.</p></div></li></ol>',15);function B(K,w,E,S,T,I){const t=i("Badge");return r(),n("div",null,[e("h1",f,[s("Installing Veeam Kasten "),o(t,{type:"tip",text:"v6.5.13"}),s(),y]),_])}const A=a(C,[["render",B]]);export{V as __pageData,A as default};
